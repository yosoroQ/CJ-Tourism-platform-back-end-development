# C# - 基于.NetCore开发的“寸金游”（后端开发）

# 一、前情提要

## 模块 or 架构

![image-20230203002248286](http://qny.expressisland.cn/schoolOpens/image-20230203002248286.png)

## RESTful成熟度模型

![image-20230203002659930](http://qny.expressisland.cn/schoolOpens/image-20230203002659930.png)

# 二、【项目启动】ASP.Net Core API 上手指南

## .Net Core的前世今生

![image-20230203003732756](http://qny.expressisland.cn/schoolOpens/image-20230203003732756.png)

### Asp.Net Core MVC

* MVC架构设计模式。
* 基于.Net的应用框架。

## 创建实战项目

### 下载.Net6

* https://dotnet.microsoft.com/zh-cn/download

![image-20230203005543249](http://qny.expressisland.cn/schoolOpens/image-20230203005543249.png)

### CMD中输入`dotnet --version`测试.Net是否安装成功

![image-20230203005743516](http://qny.expressisland.cn/schoolOpens/image-20230203005743516.png)

### 配置VS工作负荷ASP.NET

![image-20230203010029366](http://qny.expressisland.cn/schoolOpens/image-20230203010029366.png)

### 创建Hello World项目

![image-20230203010825568](http://qny.expressisland.cn/schoolOpens/image-20230203010825568.png)

```c#
namespace _00NET___HelloWorld
{
    internal class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("Hello, World!");
        }
    }
}
```

### 新建项目ASP.NET Core Web应用

![image-20230203011432172](http://qny.expressisland.cn/schoolOpens/image-20230203011432172.png)

![image-20230203011843516](http://qny.expressisland.cn/schoolOpens/image-20230203011843516.png)

### 运行测试

#### 选择IIS服务器 或者 本地服务器

![image-20230203012540895](http://qny.expressisland.cn/schoolOpens/image-20230203012540895.png)

## .NET Core的中间件、请求通道、以及环境设置

### 请求通道Request Pipeline

![image-20230203013349486](http://qny.expressisland.cn/schoolOpens/image-20230203013349486.png)

### 中间件Middelware

![image-20230203013434042](http://qny.expressisland.cn/schoolOpens/image-20230203013434042.png)

## 添加第一个API

### 注册MVC的框架依赖（Startup.cs）

```c#
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using Microsoft.AspNetCore.Builder;
using Microsoft.AspNetCore.Hosting;
using Microsoft.AspNetCore.Http;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Hosting;

namespace _01NET___CJ_ASP_Travel
{
    public class Startup
    {
        // This method gets called by the runtime. Use this method to add services to the container.
        // For more information on how to configure your application, visit https://go.microsoft.com/fwlink/?LinkID=398940
        public void ConfigureServices(IServiceCollection services)
        {
            services.AddControllers();
        }

        // This method gets called by the runtime. Use this method to configure the HTTP request pipeline.
        public void Configure(IApplicationBuilder app, IWebHostEnvironment env)
        {
            if (env.IsDevelopment())
            {
                app.UseDeveloperExceptionPage();
            }

            app.UseRouting();

            app.UseEndpoints(endpoints =>
            {
                endpoints.MapControllers();
            });
        }
    }
}
```

### 新建Controllers文件夹

#### 建立API控制器类TestApiController.cs

```c#
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;

namespace _01NET___CJ_ASP_Travel.Controllers
{
    [Route("api/[controller]")]
    [ApiController]
    public class TestApiController : ControllerBase
    {
        // GET: api/<controller>
        [HttpGet]
        public IEnumerable<string> Get()
        {
            return new string[] { "value1", "value2" };
        }

        // GET api/<controller>/5
        [HttpGet("{id}")]
        public string Get(int id)
        {
            return "value";
        }

        // POST api/<controller>
        [HttpPost]
        public void Post([FromBody] string value)
        {
        }

        // PUT api/<controller>/5
        [HttpPut("{id}")]
        public void Put(int id, [FromBody] string value)
        {
        }

        // DELETE api/<controller>/5
        [HttpDelete("{id}")]
        public void Delete(int id)
        {
        }
    }
}
```

### 访问https://localhost:7249/api/testapi

#### 请求成功

![image-20230203015311255](http://qny.expressisland.cn/schoolOpens/image-20230203015311255.png)

### 新建ShoudongAPI.cs

```c#
using Microsoft.AspNetCore.Mvc;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;

namespace FakeXiecheng.API.Controllers
{
    [Route("api/shoudongapi")]
    //[Controller]
    //public class ShoudongAPIController
    public class ShoudongAPI : Controller
    {
        [HttpGet]
        public  IEnumerable<string> Get()
        {
            return new string[] { "value1", "value2" };
        }
    }
}
```

#### 访问https://localhost:7249/api/shoudongapi

![image-20230203015535001](http://qny.expressisland.cn/schoolOpens/image-20230203015535001.png)

### 普通的类文件如何识别为控制器类

* `[Controller]`
* `xxController`
* `xx : Controller`

```c#
[Route("api/shoudongapi")]
[Controller]
public class ShoudongAPIController
    
public class 
```

* 任选一种方式即可。

## MVC架构

### ASP.NET Core MVC框架

#### 什么是MVC

![image-20230203020333965](http://qny.expressisland.cn/schoolOpens/image-20230203020333965.png)

#### 视图View

![image-20230203020359308](http://qny.expressisland.cn/schoolOpens/image-20230203020359308.png)

#### 模型Model

![image-20230203020423518](http://qny.expressisland.cn/schoolOpens/image-20230203020423518.png)

#### 控制器Controller

![image-20230203020456841](http://qny.expressisland.cn/schoolOpens/image-20230203020456841.png)

### MVC架构的数据是如何流动？

![image-20230203020703718](http://qny.expressisland.cn/schoolOpens/image-20230203020703718.png)

### MVC的优点

* 耦合性低
* 可复用性高
* 可维护性高

# 三、【数据构建】数据模型与数据库设计

## 商城数据模型设计



## 数据模型与仓库模式

## 创建数据模型和数据仓库

## 什么是Entity Framework

## 基于docker完成数据库启动

## 添加Entity Framework Core

## 创建数据库

## 添加初始化数据

## 更新数据库

## 启用MySQL数据库

# 四、【API成熟度】通往真正REST的之路

# 五、【获取产品】RESTful面向资源入门

# 六、【复合搜索】深入理解GET请求

# 七、【新建产品】POST 请求全面剖析

# 八、【更新产品】PUT vs POST

# 九、【删除产品】解读http Delete

# 十、 【项目重构】走进异步编程的世界

# 十一、 【单点登录】JWT与用户身份验证

# 十二、【购物系统从0到1】功能完整的购物车开发

# 十三、【购物系统从0到1】极简主义的订单系统

# 十四、【RESTful技能进阶】数据分页显示

# 十五、【RESTful技能进阶】数据排序

# 十六、【RESTful技能进阶】数据塑形

# 十七、 【极致RESTful风格】HATEOAS API的超媒体进化

# 十八、【项目上线】容器化、测试、和部署





